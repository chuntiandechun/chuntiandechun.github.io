<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>文件上传之绕过上传 | dlam</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一般防止上传漏洞手法1、客户端检测：客户端使用JavaScript检测，在文件未上传时，就对文件进行验证    //任何客户端的验证都是不安全的，客户端验证目的是防止用户输入错误、减少    //服务器开销，而服务端验证才可以真正防御攻击者。  2、服务器端检测：服务端脚本一般会检测文件的MIME类型，检测文件扩展名是否合法
客户端检测客户端验证代码形如下：
 123456789101112131">
<meta property="og:type" content="article">
<meta property="og:title" content="文件上传之绕过上传">
<meta property="og:url" content="http://yoursite.com/2016/07/26/文件上传之绕过上传/index.html">
<meta property="og:site_name" content="dlam">
<meta property="og:description" content="一般防止上传漏洞手法1、客户端检测：客户端使用JavaScript检测，在文件未上传时，就对文件进行验证    //任何客户端的验证都是不安全的，客户端验证目的是防止用户输入错误、减少    //服务器开销，而服务端验证才可以真正防御攻击者。  2、服务器端检测：服务端脚本一般会检测文件的MIME类型，检测文件扩展名是否合法
客户端检测客户端验证代码形如下：
 123456789101112131">
<meta property="og:updated_time" content="2016-08-05T01:06:06.043Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="文件上传之绕过上传">
<meta name="twitter:description" content="一般防止上传漏洞手法1、客户端检测：客户端使用JavaScript检测，在文件未上传时，就对文件进行验证    //任何客户端的验证都是不安全的，客户端验证目的是防止用户输入错误、减少    //服务器开销，而服务端验证才可以真正防御攻击者。  2、服务器端检测：服务端脚本一般会检测文件的MIME类型，检测文件扩展名是否合法
客户端检测客户端验证代码形如下：
 123456789101112131">
  
    <link rel="alternate" href="/atom.xml" title="dlam" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="../../../../css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="../../../../index.html" id="logo">dlam</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="../../../../index.html">Home</a>
        
          <a class="main-nav-link" href="../../../../archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-文件上传之绕过上传" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="" class="article-date">
  <time datetime="2016-07-26T11:29:50.000Z" itemprop="datePublished">2016-07-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../../../../categories/WEB/">WEB</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      文件上传之绕过上传
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>一般防止上传漏洞手法</strong><br>1、客户端检测：客户端使用JavaScript检测，在文件未上传时，就对文件进行验证<br>    //任何客户端的验证都是不安全的，客户端验证目的是防止用户输入错误、减少<br>    //服务器开销，而服务端验证才可以真正防御攻击者。  2、服务器端检测：服务端脚本一般会检测文件的MIME类型，检测文件扩展名是否合法</p>
<p><strong>客户端检测客户端验证代码形如下</strong>：</p>
<p><table bgcolor="#7FFFD4"><br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;</div><div class="line"> &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line"> &lt;title&gt;图片上传&lt;/title&gt;</div><div class="line"> &lt;script type=&quot;text/javascript&quot;&gt;</div><div class="line"> function checkFile()&#123;</div><div class="line">    var flag = false;</div><div class="line">    var str = document.getElementById(&quot;file&quot;).value;</div><div class="line">    str = str.substring(str.lastIndexOf(&apos;.&apos;) + 1);</div><div class="line">    var arr = new Array(&apos;png&apos;,&apos;bmp&apos;,&apos;gif&apos;,&apos;jpg&apos;);</div><div class="line">    for (var i=0;&lt;arr.length;i++)&#123;</div><div class="line">        if(str==arr[i])&#123;</div><div class="line">            flag = true;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    if(!flag)&#123;</div><div class="line">        alert(&apos;文件不合法！&apos;);</div><div class="line">    &#125;</div><div class="line">    return flag;</div><div class="line"> &#125;</div><div class="line"> &lt;/script&gt;&lt;/head&gt;&lt;body&gt;</div><div class="line"> &lt;form action=&quot;upload.php&quot; method=&quot;post&quot; onsubmit=&quot;checkFile()&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot; /&gt;&lt;br/&gt;</div><div class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot; name=&quot;submit&quot; /&gt;</div><div class="line"> &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</div></pre></td></tr></table></figure></table></p>
<p><br>接收文件的脚本upload.php代码如下：   </p>
<p><table><tr><td bgcolor="#7FFFD4"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;?phpif(isset($_POST[&quot;submit&quot;]))&#123;</div><div class="line">    $name = $_FILES[&apos;file&apos;][&apos;name&apos;];</div><div class="line">    $name = md5(date(&apos;Y-m-d h:m:s&apos;)).strrchr($name,&quot;.&quot;);</div><div class="line">    $size = $_FILES[&apos;file&apos;][&apos;size&apos;];</div><div class="line">    $tmp = $_FILES[&apos;file&apos;][&apos;tem_name&apos;];</div><div class="line">    move_uploaded_file($tmp,$name);</div><div class="line">    echo &quot;文件上传成功！path：&quot;.$name;</div><div class="line">&#125;</div><div class="line">?&gt;</div></pre></td></tr></table></figure></td></tr></table></p>
<p><br>绕过：1、可以用firebug将form表单中的onsubmit事件删除，这样就可以绕过验证。<br>2、使用Burp Suite：<br>    1）先将木马文件的扩展名改为一张正常图片的扩展名，如jpg<br>    2）上传时使用Burp Suite拦截数据包，将木马文件扩展名改为php就可绕过客户端验证。<br>    注意：这里修改文件名字后，请求头中的Content-Length的值也要改</p>
<p>服务端检测服务端分为6项：</p>
<ul>
<li>黑名单与白名单验证</li>
<li>MIME验证</li>
<li>目录验证</li>
<li>截断上传攻击</li>
<li>文件攻击</li>
<li>检测文件内容</li>
</ul>
<p>黑名单与白名单验证</p>
<pre><code>* 黑名单过滤方式
</code></pre><p><table><tr><td bgcolor="#7FFFD4"> </td></tr></table></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">$Blacklist = array(&apos;asp&apos;,&apos;php&apos;,&apos;jsp&apos;,&apos;php5&apos;,&apos;asa&apos;,&apos;aspx&apos;);    //黑名单if (isset($_POST[&quot;submit&quot;]))&#123;</div><div class="line">    $name = $FILES[&apos;file&apos;][&apos;name&apos;];    //接收文件名</div><div class="line">    $extension = substr(strrchr($name, &quot;.&quot;) , 1);    //得到扩展名</div><div class="line">    $boo = false;</div><div class="line">    foreach ($Blaklist as $key =&gt; $value)&#123;</div><div class="line">        if ($value==$extension) &#123;    //迭代判断是否命中</div><div class="line">            $boo = true;</div><div class="line">            break;     //命中后直接退出循环</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    if (!$boo) &#123;    //若没有被命中，则进行上传操作</div><div class="line">        $size = $_FILES[&apos;file&apos;][&apos;size&apos;];  //接收文件大小</div><div class="line">        $tmp = $FILES[&apos;file&apos;][&apos;temp_name&apos;];   //临时路径</div><div class="line">        move_uploaded_file($tmp, $name);   //移动临时文件到当前文件目录</div><div class="line">    &#125; else &#123;</div><div class="line">        echo &quot;文件不合法!!&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<p><br>对于上面的过滤可以通过如下方法绕过：</p>
<ul>
<li>从黑名单中找到web开发者忽略的扩展名，如：cer</li>
<li>没有对扩展名进行大小写转换，在window平台依然可以大小写绕过</li>
<li>在window下，若文件名以”.”或者空格作为结尾，系统会自动去除”.”与空格，<br>所以可以上传以“asp.”和“asp_”为扩展名的文件</li>
<li>0x00截断绕过</li>
<li>解析漏洞</li>
</ul>
<pre><code>* 白名单过滤方式
</code></pre><p><table><tr><td bgcolor="#7FFFD4"> </td></tr></table></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">$WhiteList = array(&apos;rar&apos;,&apos;jpg&apos;,&apos;png&apos;,&apos;bmp&apos;,&apos;gif&apos;,&apos;jpg&apos;,&apos;doc&apos;);</div><div class="line">if(isset($_POST[&quot;submit&quot;]))&#123;</div><div class="line">    $name = $_FILES[&apos;file&apos;][&apos;name&apos;];</div><div class="line">    $extension = substr(strrchr($name,&quot;.&quot;),1);</div><div class="line">    $boo = false;</div><div class="line">    foreach($WhiteList as $key =&gt; $value)&#123;</div><div class="line">        if($value==$extension)&#123;</div><div class="line">            $boo = true;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    if($boo)&#123;</div><div class="line">        $size = $_FILES[&apos;file&apos;][&apos;size&apos;];</div><div class="line">        $tmp = $_FILES[&apos;file&apos;][&apos;tmp_name&apos;];</div><div class="line">        move_uploaded_file($tmp,$name);</div><div class="line">        echo &quot;文件上传成功！&lt;br/&gt;path:&quot;.$name;</div><div class="line">    &#125;else&#123;</div><div class="line">        echo &quot;文件不合法！&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<p><br>绕过方法：</p>
<ul>
<li>0x00截断绕过</li>
<li>此时若在iis6.0，则可以将木马名改为test.asp;1.jpg来上传，从而通过验证</li>
<li>配合解析漏洞</li>
</ul>
<p>MIME验证对文件MIME类型做验证的PHP代码如下：</p>
<p><table><tr><td bgcolor="#7FFFD4"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;?phpif($_FILES[&apos;file&apos;][&apos;type&apos;]==&quot; image/jpeg&quot;)&#123;</div><div class="line">    $imageTempName = $_FILES[&apos;file&apos;][&apos;tmp_name&apos;];</div><div class="line">    $imageName = $_FILES[&apos;file&apos;][&apos;name&apos;];</div><div class="line">    $last = substr($imageName,strrpos($imageName,&quot;.&quot;));</div><div class="line">    if(!is_dir(&quot;uploadFile&quot;))&#123;</div><div class="line">        mkdir(&quot;uploadFile&quot;);</div><div class="line">    &#125;</div><div class="line">    $imageName = md5($imageName).$last;</div><div class="line">    move_upload_file($imageTempName,&quot;./uploadFile/&quot;.$imageName);</div><div class="line">    echo(&quot;文件上传成功！ path = /uploadFile/$imageName&quot;);</div><div class="line">&#125;else&#123;</div><div class="line">    echo(&quot;文件上传类型错误，请重新上传...&quot;);</div><div class="line">    exit();</div><div class="line">&#125;</div><div class="line">?&gt;</div></pre></td></tr></table></figure></td></tr></table></p>
<p><br>未修改MIME类型，上传失败：<br>修改MIME类型，上传成功：<br>目录验证文件上传时通常允许用户将文件放到指定的目录中，若目录存在则将文件写入目录，否则新建目录然后写入，若为iis6.0则可以利用这个漏洞，客户端上传代码如下：</p>
<p><table><tr><td bgcolor="#7FFFD4"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> &lt;html&gt;&lt;head&gt;</div><div class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">&lt;title&gt;up&lt;/title&gt;&lt;/head&gt;&lt;body&gt;</div><div class="line">&lt;form action=&quot;upload.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;&lt;br/&gt;</div><div class="line">    &lt;input type=&quot;hidden&quot; name=&quot;Extension&quot; value=&quot;up&quot; /&gt;</div><div class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot; name=&quot;submit&quot; /&gt;</div><div class="line">&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</div></pre></td></tr></table></figure></td></tr></table></p>
<p><br>服务端PHP接收文件的代码如下：</p>
<p><table><tr><td bgcolor="#7FFFD4"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">    $imageTempName=$_FILES[&apos;file&apos;][&apos;tmp_name&apos;];</div><div class="line">    $imageName=$_FILES[&apos;file&apos;][&apos;name&apos;];</div><div class="line">    $last=substr($imageName,strrpos($imageName,&quot;.&quot;));</div><div class="line">    if($last!=&quot;.jpg&quot;)&#123;</div><div class="line">        echo(&quot;mime error!&lt;br/&gt;&quot;);</div><div class="line">    &#125;</div><div class="line">    $Extension=$_POST[&apos;Extension&apos;];</div><div class="line">    if(!is_dir($Extension))&#123;</div><div class="line">        mkdir(&quot;./$Extension&quot;);</div><div class="line">        echo &quot;mkidr $Extension succesfully&quot;.&quot;&lt;br/&gt;&quot;;</div><div class="line">    &#125;</div><div class="line">    $imageName=md5($imageName).$last;</div><div class="line">    move_uploaded_file($imageTempName,&quot;./$Extension/&quot;.$imageName);</div><div class="line">    echo(&quot;upload ok! path = /$Extension/$imageName&quot;);</div><div class="line">&#125; else &#123;</div><div class="line">    echo(&quot;type error...&quot;);</div><div class="line">    exit();</div><div class="line">&#125;</div><div class="line">?&gt;</div></pre></td></tr></table></figure></td></tr></table></p>
<p><br>查看上传到了那个文件：<br>将文件改名：<br>截断上传攻击截断上传攻击在ASP程序中比较常见(在PHP、JSP中也有) 先上传正常后缀的图片马：<br>更改图片名字：</p>
<p>截断：</p>
<p>上传成功：<br>文件攻击</p>
<pre><code>* .htaccess文件攻击
</code></pre><p>通过.htaccess文件调用php解析器去解析一个文件名中只要包含”haha”这个字符串的任意文件，无论扩展名是什么(没有也行)，都以php的方式来解析，.haccess文件代码如下：</p>
<filesmatch "haha"="">SetHandler application/x-httpd-php<br></filesmatch><br>或者如下，上传一个文件名为evil.gif的图片马：<br><filesmatch "evil.gif"=""><br><br>SetHandler application/x-httpd-php<br></filesmatch>

<pre><code>* .user.ini文件攻击
</code></pre><p>只要中间键是以fastcgi运行的php都可以用这个方法，.user.ini能被动态加载，它也有两个配置<br>项：auto_append_file和auto_prepend_file，只要在.user.ini中添加auto_prepend_file=aa.jpg<br>这句话，就可以让其他php文件执行前自动包含aa.jpg，和require()类似。</p>
<p>检测文件内容</p>
<pre><code>* 文件幻数检测
</code></pre><p>在文件首部加上如下幻数，后面跟一句话木马即可</p>
<p>JFIF    FF D8 FF E0 00 10 4A 46 49 46<br>GIF89a  47 49 46 38 39 61<br>PNG     89 50 4E 47</p>
<pre><code>* 文件相关信息检测
</code></pre><p>通常用的getimagesize()函数，只需要在幻数基础上加一些文件信息就行了，如下：</p>
<p>GIF89a<br>(…some binary data for image…)<br>&lt;?php phpinfo(); ?&gt;<br>(… skipping the rest of binary data …)</p>
<pre><code>* 文件加载检测
</code></pre><p>服务端会调用API或函数对文件进行加载测试，常见的是图像渲染测试，变态的甚至是二次渲染：</p>
<p>对渲染/加载测试的攻击方式是代码注入绕过<br>对二次渲染的攻击方式是攻击文件加载器本身</p>
<p>文件上传之文本编辑器漏洞<br>常见的文本编辑器有CKEditor、eWebEditor、UEditor、KindEditor、xhEditor等，它们的功能类似且都有图片上传、视频上传、远程下载等功能，这类文本编辑器也称为富文本编辑器。<br>下面以FCKeditor(现名为CKEditor)为例：<br>1、敏感信息暴漏<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">* 查看版本信息</div><div class="line">    /FCKeditor/editor/dialog/fck_about.html</div><div class="line">* 默认上传页面</div><div class="line">    /FCKeditor/editor/filemanager/browser/default/browser.html</div><div class="line">    /FCKeditor/editor/filemanager/browser/default/connectors/test.html</div><div class="line">    /FCKeditor/editor/filemanager/upload/test.html</div><div class="line">    /FCKeditor/editor/filemanager/connectors/test.html</div><div class="line">    /FCKeditor/editor/filemanager/connectors/uploadtest.html</div><div class="line">* 其他敏感文件</div><div class="line">    /FCKeditor/editor/filemanager/connectors/aspx/connector.html</div><div class="line">    /FCKeditor/editor/filemanager/connectors/asp/connector.html</div><div class="line">    /FCKeditor/editor/filemanager/connectors/php/connector.php</div></pre></td></tr></table></figure></p>
<p>2、黑名单策略错误<br>    FCKeditor&lt;=2.4.3版本采用的是有弊端的黑名单策略，可以采用asa、cer等扩展名<br>3、任意文件上传漏洞<br>    FCKeditor的2.4.2及以下本本的黑名单配置信息里没有定义类型Media，直接构造html表单就行，<br>在form中的action=”<a href="http://22.22.22.22/fckeditor/editor/filemanager/upload/php/upload.php?Type=M" target="_blank" rel="external">http://22.22.22.22/fckeditor/editor/filemanager/upload/php/upload.php?Type=M</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/07/26/文件上传之绕过上传/" data-id="cis8apn300021v8hrccjkg03p" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2016/07/26/文件上传之绕过上传/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/上传/">上传</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../../29/命令执行漏洞/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          命令执行漏洞
        
      </div>
    </a>
  
  
    <a href="../文件上传/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">文件上传</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../../../../categories/WEB/">WEB</a></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/安全/">安全</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/centos/">centos</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/csrf/">csrf</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/github/">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/google/">google</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/linux问题/">linux问题</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/metasploit/">metasploit</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/openssl/">openssl</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/sqlmap/">sqlmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/sql注入/">sql注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/tcp-ip/">tcp/ip</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/webshell/">webshell</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/win2003/">win2003</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/xss/">xss</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/上传/">上传</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/执行/">执行</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/敏感信息/">敏感信息</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/文件包含/">文件包含</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/流程/">流程</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/逻辑/">逻辑</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="../../../../tags/centos/" style="font-size: 16.67px;">centos</a> <a href="../../../../tags/csrf/" style="font-size: 10px;">csrf</a> <a href="../../../../tags/github/" style="font-size: 10px;">github</a> <a href="../../../../tags/google/" style="font-size: 10px;">google</a> <a href="../../../../tags/linux问题/" style="font-size: 10px;">linux问题</a> <a href="../../../../tags/metasploit/" style="font-size: 10px;">metasploit</a> <a href="../../../../tags/mysql/" style="font-size: 10px;">mysql</a> <a href="../../../../tags/openssl/" style="font-size: 10px;">openssl</a> <a href="../../../../tags/redis/" style="font-size: 13.33px;">redis</a> <a href="../../../../tags/sqlmap/" style="font-size: 10px;">sqlmap</a> <a href="../../../../tags/sql注入/" style="font-size: 20px;">sql注入</a> <a href="../../../../tags/tcp-ip/" style="font-size: 10px;">tcp/ip</a> <a href="../../../../tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="../../../../tags/webshell/" style="font-size: 10px;">webshell</a> <a href="../../../../tags/win2003/" style="font-size: 10px;">win2003</a> <a href="../../../../tags/xss/" style="font-size: 13.33px;">xss</a> <a href="../../../../tags/上传/" style="font-size: 16.67px;">上传</a> <a href="../../../../tags/执行/" style="font-size: 13.33px;">执行</a> <a href="../../../../tags/敏感信息/" style="font-size: 10px;">敏感信息</a> <a href="../../../../tags/文件包含/" style="font-size: 10px;">文件包含</a> <a href="../../../../tags/流程/" style="font-size: 10px;">流程</a> <a href="../../../../tags/逻辑/" style="font-size: 10px;">逻辑</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2016/05/">May 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="../../../08/19/centos6-5安装metasploit/">centos6.5安装metasploit</a>
          </li>
        
          <li>
            <a href="../../../08/18/openssl心脏滴血漏洞/">openssl心脏滴血漏洞</a>
          </li>
        
          <li>
            <a href="../../../08/11/文件上传之解析漏洞/">文件上传之解析漏洞</a>
          </li>
        
          <li>
            <a href="../../../08/08/centos搭建tomcat以及漏洞利用/">centos搭建tomcat以及漏洞利用</a>
          </li>
        
          <li>
            <a href="../../../08/05/webshell的获取与查杀/">webshell的获取与查杀</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 春天的春，晴天的晴<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="../../../../index.html" class="mobile-nav-link">Home</a>
  
    <a href="../../../../archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'liuqi';
  
  var disqus_url = 'http://yoursite.com/2016/07/26/文件上传之绕过上传/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="../../../../fancybox/jquery.fancybox.css">
  <script src="../../../../fancybox/jquery.fancybox.pack.js"></script>


<script src="../../../../js/script.js"></script>

  </div>
</body>
</html>